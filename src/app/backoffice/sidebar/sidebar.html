<!-- Overlay pour mobile -->
<div
  *ngIf="sidebarOpen"
  class="fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden"
  (click)="toggleSidebar()"
></div>

<aside
  class="w-64 bg-base-100 border-r border-base-200 fixed top-16 bottom-0 left-0 z-40 overflow-y-auto shadow-lg transition-transform duration-300 ease-in-out transform lg:translate-x-0"
  [ngClass]="{
    '-translate-x-full': !sidebarOpen,
    'translate-x-0': sidebarOpen
  }"
>
  <div class="p-4 space-y-6">
    <!-- Section Navigation principale -->
    <div>
      <div
        class="text-xs font-semibold text-base-content/60 uppercase tracking-wider mb-4 px-2"
      >
        <div class="flex items-center gap-2">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-4 h-4"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"
            />
          </svg>
          Navigation
        </div>
      </div>

      <ul class="space-y-1">
        <!-- Tableau de bord -->
        <li>
          <a
            routerLink="/backoffice/dashboard"
            routerLinkActive="bg-primary/10 text-primary border-l-4 border-primary"
            [routerLinkActiveOptions]="{ exact: true }"
            class="group flex items-center gap-3 px-3 py-3 rounded-xl text-base-content hover:bg-base-200 hover:shadow-md transition-all duration-300 hover:scale-[1.02]"
          >
            <div
              class="p-2 rounded-lg bg-primary/20 group-hover:bg-primary/30 transition-colors duration-200"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-5 h-5"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <span class="font-semibold text-sm">Tableau de bord</span>
              <div class="text-xs text-primary/70 mt-0.5">Vue d'ensemble</div>
            </div>
            <div class="w-2 h-2 rounded-full bg-primary animate-pulse"></div>
          </a>
        </li>

        <!-- Gestion des auteurs -->
        <li>
          <a
            routerLink="/backoffice/auteurs"
            routerLinkActive="bg-primary/10 text-primary border-l-4 border-primary"
            class="group flex items-center gap-3 px-3 py-3 rounded-xl text-base-content hover:bg-base-200 hover:shadow-md transition-all duration-300 hover:scale-[1.02]"
          >
            <div
              class="p-2 rounded-lg bg-base-200 group-hover:bg-primary/10 transition-colors duration-200"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-5 h-5 group-hover:text-primary transition-colors duration-200"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <span class="font-medium text-sm">Gestion des auteurs</span>
              <div class="text-xs text-base-content/60 mt-0.5">Référentiel</div>
            </div>
          </a>
        </li>

        <!-- Gestion des catégories -->
        <li>
          <a
            routerLink="/backoffice/categories"
            routerLinkActive="bg-primary/10 text-primary border-l-4 border-primary"
            class="group flex items-center gap-3 px-3 py-3 rounded-xl text-base-content hover:bg-base-200 hover:shadow-md transition-all duration-300 hover:scale-[1.02]"
          >
            <div
              class="p-2 rounded-lg bg-base-200 group-hover:bg-primary/10 transition-colors duration-200"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-5 h-5 group-hover:text-primary transition-colors duration-200"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M3.75 6.75h16.5M3.75 12h16.5M3.75 17.25h16.5"
                />
              </svg>
            </div>
            <div class="flex-1">
              <span class="font-medium text-sm">Gestion des catégories</span>
              <div class="text-xs text-base-content/60 mt-0.5">Référentiel</div>
            </div>
          </a>
        </li>

        <!-- Gestion des livres -->
        <li>
          <a
            routerLink="/backoffice/livres"
            routerLinkActive="bg-primary/10 text-primary border-l-4 border-primary"
            class="group flex items-center gap-3 px-3 py-3 rounded-xl text-base-content hover:bg-base-200 hover:shadow-md transition-all duration-300 hover:scale-[1.02]"
          >
            <div
              class="p-2 rounded-lg bg-base-200 group-hover:bg-primary/10 transition-colors duration-200"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-5 h-5 group-hover:text-primary transition-colors duration-200"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"
                />
              </svg>
            </div>
            <div class="flex-1">
              <span class="font-medium text-sm">Gestion des livres</span>
              <div class="text-xs text-base-content/60 mt-0.5">
                Catalogue complet
              </div>
            </div>
            <div class="badge badge-ghost badge-sm">
              {{ countLivres ?? "…" }}
            </div>
          </a>
        </li>

        <!-- Emprunts -->
        <li>
          <a
            routerLink="/backoffice/emprunts"
            routerLinkActive="bg-primary/10 text-primary border-l-4 border-primary"
            class="group flex items-center gap-3 px-3 py-3 rounded-xl text-base-content hover:bg-base-200 hover:shadow-md transition-all duration-300 hover:scale-[1.02]"
          >
            <div
              class="p-2 rounded-lg bg-base-200 group-hover:bg-secondary/10 transition-colors duration-200"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-5 h-5 group-hover:text-secondary transition-colors duration-200"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a3.375 3.375 0 00-3.375 3.375V18.75m0 0H6A2.25 2.25 0 013.75 16.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a3.375 3.375 0 00-3.375 3.375V18.75"
                />
              </svg>
            </div>
            <div class="flex-1">
              <span class="font-medium text-sm">Emprunts</span>
              <div class="text-xs text-base-content/60 mt-0.5">
                Gestion active
              </div>
            </div>
            <div class="badge badge-secondary badge-sm">
              {{ countEmpruntsActifs ?? "…" }}
            </div>
          </a>
        </li>

        <!-- Réservations -->
        <li>
          <a
            routerLink="/backoffice/reservations"
            routerLinkActive="bg-primary/10 text-primary border-l-4 border-primary"
            class="group flex items-center gap-3 px-3 py-3 rounded-xl text-base-content hover:bg-base-200 hover:shadow-md transition-all duration-300 hover:scale-[1.02]"
          >
            <div
              class="p-2 rounded-lg bg-base-200 group-hover:bg-accent/10 transition-colors duration-200"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-5 h-5 group-hover:text-accent transition-colors duration-200"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"
                />
              </svg>
            </div>
            <div class="flex-1">
              <span class="font-medium text-sm">Réservations</span>
              <div class="text-xs text-base-content/60 mt-0.5">En attente</div>
            </div>
            <div class="badge badge-accent badge-sm">
              {{ countReservationsActives ?? "…" }}
            </div>
          </a>
        </li>
      </ul>
    </div>

    <!-- Divider avec style moderne -->
    <div class="relative">
      <div class="absolute inset-0 flex items-center">
        <div class="w-full border-t border-base-300"></div>
      </div>
      <div class="relative flex justify-center text-xs uppercase">
        <span class="bg-base-100 px-2 text-base-content/50 font-medium"
          >Administration</span
        >
      </div>
    </div>

    <!-- Section Administration -->
    <div>
      <ul class="space-y-1">
        <!-- Utilisateurs - Admin uniquement -->
        <li *ngIf="isAdmin" data-role="admin">
          <a
            routerLink="/backoffice/utilisateurs"
            routerLinkActive="bg-primary/10 text-primary border-l-4 border-primary"
            class="group flex items-center gap-3 px-3 py-3 rounded-xl text-secondary hover:bg-secondary/10 hover:shadow-md transition-all duration-300 hover:scale-[1.02]"
          >
            <div
              class="p-2 rounded-lg bg-secondary/10 group-hover:bg-secondary/20 transition-colors duration-200"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-5 h-5"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <span class="font-medium text-sm">Utilisateurs</span>
              <div class="text-xs text-secondary/70 mt-0.5">
                Gestion des comptes
              </div>
            </div>
            <div class="badge badge-secondary badge-sm">
              {{ countUtilisateurs ?? "…" }}
            </div>
          </a>
        </li>

        <!-- Abonnements -->
        <li data-role="admin">
          <a
            routerLink="/backoffice/abonnements"
            routerLinkActive="bg-primary/10 text-primary border-l-4 border-primary"
            class="group flex items-center gap-3 px-3 py-3 rounded-xl text-accent hover:bg-accent/10 hover:shadow-md transition-all duration-300 hover:scale-[1.02]"
          >
            <div
              class="p-2 rounded-lg bg-accent/10 group-hover:bg-accent/20 transition-colors duration-200"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-5 h-5"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 002.25-2.25V6.75A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25v10.5A2.25 2.25 0 004.5 19.5z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <span class="font-medium text-sm">Abonnements</span>
              <div class="text-xs text-accent/70 mt-0.5">
                Gestion des souscriptions
              </div>
            </div>
            <div class="badge badge-accent badge-sm">
              {{ countAbonnements ?? "…" }}
            </div>
          </a>
        </li>

        <!-- Paramètres - Admin uniquement -->
      </ul>
    </div>

    <!-- Section de statut en bas -->
    <div class="mt-auto pt-6">
      <div
        class="bg-gradient-to-r from-primary/5 to-secondary/5 rounded-xl p-4 border border-base-300"
      >
        <div class="flex items-center gap-3">
          <div class="avatar placeholder">
            <div class="bg-primary text-primary-content rounded-full w-10 h-10">
              <span class="text-xs font-bold">BU</span>
            </div>
          </div>
          <div class="flex-1">
            <div class="font-semibold text-sm text-base-content">
              Système actif
            </div>
            <div class="text-xs text-base-content/60">
              Tous les services opérationnels
            </div>
          </div>
          <div class="w-3 h-3 bg-success rounded-full animate-pulse"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Styles CSS pour les animations -->
  <style>
    /* Animation de slide-in pour les éléments du menu */
    aside ul li {
      animation: slideInLeft 0.6s ease-out;
    }

    aside ul li:nth-child(1) {
      animation-delay: 0.1s;
    }
    aside ul li:nth-child(2) {
      animation-delay: 0.2s;
    }
    aside ul li:nth-child(3) {
      animation-delay: 0.3s;
    }
    aside ul li:nth-child(4) {
      animation-delay: 0.4s;
    }
    aside ul li:nth-child(5) {
      animation-delay: 0.5s;
    }

    @keyframes slideInLeft {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    /* Effet de hover amélioré */
    aside ul li a:hover {
      transform: translateX(4px);
    }

    /* Animation pour les badges */
    .badge {
      animation: fadeIn 1s ease-in-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }
  </style>
</aside>
